{% extends "two_factor/_base_focus.html" %}
{% load i18n %}
{%  load static %}

{% block extra_head %}
  <link rel="stylesheet" href="{% static 'css/login_style.css' %}"/>
{% endblock %}

{% block extra_media %}
  {{ form.media }}
{% endblock %}

{% block content %}
<section class="bg-gray-50 dark:bg-gray-900">
  <div class="flex flex-col items-center justify-center px-6 py-8 mx-auto md:h-screen lg:py-0">
      <div class="flex items-center mb-6 text-2xl font-semibold text-gray-900 dark:text-white">
          <img class="w-8 h-8 mr-2" src="https://flowbite.s3.amazonaws.com/blocks/marketing-ui/logo.svg" alt="logo">
          OKR SPACE    
      </div>
      <div style="padding: 60px; text-align: center; align-items: center;" class="w-full bg-white rounded-lg shadow dark:border md:mt-0 sm:max-w-md xl:p-0 dark:bg-gray-800 dark:border-gray-700">
        <h1 style="font-weight: bold; font-size: 20px;">{% block title %}{% trans "Enable Two-Factor Authentication" %}{% endblock %}</h1>
        {% if wizard.steps.current == 'generator' %}
        <p>{% blocktrans trimmed %}To start using a token generator, please use your
          smartphone to scan the QR code below. For example, use Google
          Authenticator.{% endblocktrans %}</p>
        <img style="display: inline;" src="{{ QR_URL }}" alt="QR Code" class="bg-white"/>
        <p>{% blocktrans %}Then, enter the token generated by the app.{% endblocktrans %}</p>
        {% elif wizard.steps.current == 'welcome' %}
        <p>{% blocktrans trimmed %}You are about to take your account security to the
        next level. Follow the steps in this wizard to enable two-factor
        authentication.{% endblocktrans %}</p>
        {% endif %}
      <form action="" method="post">{% csrf_token %}
        {% include "two_factor/_wizard_forms.html" %}
    
        {# hidden submit button to enable [enter] key #}
        <input type="submit" value="" hidden />
      <button type="submit" class="w-full bg-blue-600 text-white bg-primary-600 hover:bg-primary-700 focus:ring-4 focus:outline-none focus:ring-primary-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-primary-600 dark:hover:bg-primary-700 dark:focus:ring-primary-800 btn btn-primary">{% trans "Next" %}</button>

    
      </form>
          </div>
      </div>
  </div>
</section>

<script>
  // Obt√©m o elemento de input pelo ID
  const inputElement = document.getElementById("id_generator-token");
  inputElement.style.cssText="width: 100%; border-radius: 6px; margin-top: 5px;"
  const td = inputElement.parentElement
  const tr = td.parentElement
  const token = tr.querySelector('th')
  console.log(token)
  token.style.cssText="display: none;"
</script>

{% if wizard.steps.current == 'welcome' %}
<div>
  {% if wizard.steps.current == 'welcome' %}
    <p>{% blocktrans trimmed %}You are about to take your account security to the
        next level. Follow the steps in this wizard to enable two-factor
        authentication.{% endblocktrans %}</p>
  {% elif wizard.steps.current == 'method' %}
    <p>{% blocktrans trimmed %}Please select which authentication method you would
        like to use.{% endblocktrans %}</p>
  {% elif wizard.steps.current == 'sms' %}
    <p>{% blocktrans trimmed %}Please enter the phone number you wish to receive the
      text messages on. This number will be validated in the next step.
      {% endblocktrans %}</p>
  {% elif wizard.steps.current == 'call' %}
    <p>{% blocktrans trimmed %}Please enter the phone number you wish to be called on.
      This number will be validated in the next step. {% endblocktrans %}</p>
  {% elif wizard.steps.current == 'validation' %}
    {% if challenge_succeeded %}
      {% if device.method == 'call' %}
        <p>{% blocktrans trimmed %}We are calling your phone right now, please enter the
          digits you hear.{% endblocktrans %}</p>
      {% elif device.method == 'sms' %}
        <p>{% blocktrans trimmed %}We sent you a text message, please enter the tokens we
          sent.{% endblocktrans %}</p>
      {% endif %}
    {% else %}
      <p class="alert alert-warning" role="alert">{% blocktrans trimmed %}We've
        encountered an issue with the selected authentication method. Please
        go back and verify that you entered your information correctly, try
        again, or use a different authentication method instead. If the issue
        persists, contact the site administrator.{% endblocktrans %}</p>
    {% endif %}
  {% elif wizard.steps.current == 'yubikey' %}
    <p>{% blocktrans trimmed %}To identify and verify your YubiKey, please insert a
      token in the field below. Your YubiKey will be linked to your
      account.{% endblocktrans %}</p>
  {% endif %}

  <form action="" method="post">{% csrf_token %}
    {% include "two_factor/_wizard_forms.html" %}

    {# hidden submit button to enable [enter] key #}
    <input type="submit" value="" hidden />

    {% include "two_factor/_wizard_actions.html" %}
  </form>
</div>
{% endif %}
{% endblock %}
